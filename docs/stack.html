<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <title>The importance of being stackless <small>and optimizing tail calls</small></title>
        <link rel="stylesheet" href="/style.css">
        <link rel="icon" sizes="109x109" href="/favicon.gif" />
    </head>
    <body>
        <center><span id='home'><a title='Home' href='/'>&#9632;</a></span></center>
        <h1>The importance of being stackless <small>and optimizing tail calls</small></h1>

<p>A while ago I gave a talk called <a href="youtu.be/CpjUoYcaUu8">Critique of Python</a>.
I gave it on two occasions and had a lot of discussions afterwards.
One of the points of my critique was that Python is not
<em>stackless</em> and it doesn&#8217;t optimize away <em>tail-calls</em>.
I didn&#8217;t convince quite a lot
of people that these techniques are necessary.
And here I
want to expand on why I think they are essential.</p>

<h2>What is <em>tail-call optimization</em>? <small>Skip this if you know</small></h2>

<p>A function call is in a <em>tail position</em> if the result of the
call is used as the return value of the another function.</p>

<p>Here are some examples:</p>

<pre><code>def foo():
    tmp_1 = call_1()
    tmp_2 = call_1(tmp_1)
    return bar(tmp_2)  # Tail call.

def foo():
    tmp = bar()  # Tail call,
    return tmp   # the value is returned immediately.

def foo():
    tmp = bar()  # Not a tail call,
    tmp.x = 10   # the value is returned modified.
    return tmp
</code></pre>

<p>The interesting property of a
def foo(a):
    b = 2
    def bar(x):
        y = 4
        return inspect.stack()
    return bar(b)</p>

    </body>
</html>
